{% extends "base.html" %}
{% block title %}Login - InvenGuardCO{% endblock %}
{% block content %}
<article class="card-center">
    <header>
        <h2>üëãüèΩ Welcome</h2>
        <h3>Log in to your account</h3>
    </header>
    
    <div id="login-container">
        {% if error %}
        <div class="alert alert-error" role="alert">
            <strong>Error:</strong> {{ error }}
        </div>
        {% endif %}
        <form id="login-form"
              hx-post="/auth/login"
              hx-target="#login-container"
              hx-swap="innerHTML"
              hx-indicator="#login-spinner">
            
            <label>
                Email
                <input type="email" 
                       id="email" 
                       name="email" 
                       placeholder="tu@email.com"
                       required
                       autocomplete="email">
            </label>
            
            <label>
                Password
                <input type="password" 
                       id="password" 
                       name="password" 
                       placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                       required
                       autocomplete="current-password">
            </label>
            
            <button type="submit" aria-busy="false">
                Log In
                <span id="login-spinner" class="htmx-indicator spinner"></span>
            </button>
        </form>
    </div>
    
    <footer class="text-center mt-2">
        <small>
            <a href="/">üîô Back to Home</a>
        </small>
    </footer>
</article>

<script>
    document.body.addEventListener('htmx:beforeRequest', function(evt) {
        if (evt.detail.elt.id === 'login-form') {
            const btn = evt.detail.elt.querySelector('button[type="submit"]');
            btn.setAttribute('aria-busy', 'true');
        }
    });
    
    document.body.addEventListener('htmx:afterRequest', function(evt) {
        if (evt.detail.elt.id === 'login-form') {
            const btn = evt.detail.elt.querySelector('button[type="submit"]');
            btn.setAttribute('aria-busy', 'false');
        }
    });
</script>
{% endblock %}