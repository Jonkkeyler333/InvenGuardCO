{% extends "base.html" %}
{% block title %}Login - InvenGuardCO{% endblock %}
{% block content %}
    <main class="container">
        <article style="max-width: 400px; margin: 2rem auto;">
            <header>
                <h2>Hey üëãüèΩ</h2>
                <h3>Please log in to your account</h3>
            </header>
            <div id="login-container">
                {% if error %}
                    <div id="login-error" role="alert" style="margin-bottom: 1rem;">
                        {{ error }}
                    </div>
                {% endif %}
                <form id="login-form"
                      hx-post="/auth/login"
                      hx-target="#login-container"
                      hx-swap="innerHTML"
                      hx-indicator="#login-spinner">
                    
                    <label>
                        Email
                        <input type="text" 
                               id="email" 
                               name="email" 
                               placeholder="tu@email.com"
                               required
                               >
                    </label>
                    
                    <label>
                        Contrase√±a
                        <input type="password" 
                               id="password" 
                               name="password" 
                               placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                               required
                               autocomplete="current-password">
                    </label>
                    
                    <button type="submit" aria-busy="false">
                        Login
                        <span id="login-spinner" 
                              class="htmx-indicator" 
                              style="display: none; margin-left: 0.5rem;">
                            ‚è≥
                        </span>
                    </button>
                </form>
            </div>
            
            <footer style="text-align: center; margin-top: 1.5rem;">
                <small>
                    <a href="/">‚Üê Back to Home</a>
                </small>
            </footer>
        </article>
    </main>
    <script>
        document.body.addEventListener('htmx:beforeRequest', function(evt) {
            if (evt.detail.elt.id === 'login-form') {
                document.querySelector('button[type="submit"]').setAttribute('aria-busy', 'true');
            }
        });
        
        document.body.addEventListener('htmx:afterRequest', function(evt) {
            if (evt.detail.elt.id === 'login-form') {
                document.querySelector('button[type="submit"]').setAttribute('aria-busy', 'false');
            }
        });
    </script>
{% endblock %}